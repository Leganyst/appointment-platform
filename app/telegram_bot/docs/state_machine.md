# Client State Machine (Context Note)

## States
- S0 — Welcome / Первый запуск: приветствие, авто-ID по Telegram ID, кнопки «к выбору роли» / «в главное меню».
- S1 — RoleSetup: выбор роли, подтверждение, затем в главное меню.
- S2 — ClientMainMenu: «Поиск услуг», «Мои записи», «Профиль», «Помощь» (+ опц. смена роли).
- S3 — ServiceSearch: выбор услуги, уточнения, список представителей, возврат в меню.
- S4 — SlotsView: инфо о представителе, список слотов (дата/время кнопками), навигация, «назад к выбору представителя».
- S5 — BookingConfirm: сводка, кнопки «Подтвердить» / «Отменить (к слотам)».
- S6 — BookingResult: успех/отказ; после успеха CTA в «Мои записи» или меню.
- S7 — MyBookings: активные+прошедшие, выбор записи, отмена активной, возврат в меню.
- S8 — BookingDetails (optional): подробности выбранной записи.
- S9 — CancelResult: сообщение об успехе/ошибке отмены и дальнейшие действия.
- S10 — ProfileHelp: данные пользователя, описание, команды/разделы, поддержка, назад в меню.

## Transitions
- /start → S0
- S0 «Выбор роли/настройка» → S1
- S0 «Главное меню» → S2
- S1 «Клиент» + «Подтвердить» → S2
- S2 «Поиск услуг» → S3
- S3 выбрать представителя → S4
- S3 «В главное меню» → S2
- S4 выбрать слот → S5
- S4 «Назад к выбору представителя» → S3
- S5 «Отменить» → S4
- S5 «Подтвердить» → S6
- S6 (успех) «Мои записи» → S7
- S6 (успех) «Главное меню» → S2
- S6 (ошибка) остаёмся в S6; далее пользователь выбирает следующее действие (обычно назад к поиску/слотам)
- S2 «Мои записи» → S7
- S7 выбрать запись → S8
- S7 «Отменить активное бронирование» → S9
- S9 завершение → S7 или S2 (по кнопкам в сервисном сообщении)
- S7 «В главное меню» → S2
- S2 «Профиль» или «Помощь» → S10
- S10 «В главное меню» → S2

Notes: списки слотов/записей структурированы (дата/время/исполнитель/статус), действия через инлайн-кнопки, сервисные сообщения объясняют результат и предлагают следующий шаг.
